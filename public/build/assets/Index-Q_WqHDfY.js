import{m as k,x as B,a as T,C as V,c as l,o as r,b as x,d as t,f as g,t as i,e as u,v as b,Q as K,g as N,F as E,r as M,w as U,u as n,W as _,D as A}from"./app-C0tTr7Qq.js";import{S as f}from"./sweetalert2.esm.all-ePrzfkxH.js";import D from"./AdminNavbar-D18K6OyB.js";import $ from"./AdminSidebar-COanCy1K.js";import{_ as F}from"./Pagination-BvFjk2ok.js";const I={class:"flex min-h-screen bg-gray-50"},O={class:"flex-1 flex flex-col"},q={class:"flex-1 p-6 space-y-6"},H={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},W={class:"lg:col-span-2 bg-white rounded-xl shadow p-6 space-y-4"},z={key:0,class:"rounded-lg bg-green-50 border border-green-200 text-green-800 px-4 py-3"},G={class:"flex flex-col md:flex-row md:items-end md:space-x-4 space-y-3 md:space-y-0"},L={class:"flex-1"},Q={key:1,class:"text-sm text-gray-500"},R={key:2,class:"overflow-auto"},Y={class:"min-w-full divide-y divide-gray-200"},J={class:"bg-white divide-y divide-gray-200"},P={class:"px-6 py-4 text-gray-800"},X={class:"px-6 py-4"},Z={class:"px-6 py-4 text-sm text-gray-600"},tt={class:"px-6 py-4 text-right"},et=["onClick"],st={class:"mt-4"},ot={class:"space-y-6"},it={class:"bg-white rounded-xl shadow p-6"},nt={class:"space-y-3 text-sm text-gray-700"},lt={class:"flex items-center justify-between"},rt={class:"font-semibold"},at={class:"flex items-center justify-between"},dt={class:"font-semibold text-green-600"},ut={class:"flex items-center justify-between"},ct={class:"font-semibold text-gray-600"},mt={class:"bg-white rounded-xl shadow p-6"},pt={key:0,class:"text-sm text-red-600 mt-1"},xt={key:0,class:"text-sm text-red-600 mt-1"},gt=["disabled"],kt={__name:"Index",props:{subscribers:Object,filters:Object,stats:Object},setup(a){var h,w;const y=a,c=k(((h=y.filters)==null?void 0:h.q)||""),m=k(((w=y.filters)==null?void 0:w.status)||""),o=B({subject:"",content:""}),S=T(),v=V(()=>{var d;return((d=S.props.flash)==null?void 0:d.status)||""}),p=()=>{_.get(route("admin.newsletter.index"),{q:c.value,status:m.value},{preserveState:!0,preserveScroll:!0})},C=()=>{o.post(route("admin.newsletter.send"),{preserveScroll:!0,onSuccess:()=>{o.reset("subject","content")}})},j=d=>{f.fire({title:"Hapus subscriber?",text:"Email akan dihapus dari daftar newsletter.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#DC2626",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"}).then(e=>{e.isConfirmed&&_.delete(route("admin.newsletter.destroy",d),{preserveScroll:!0,onSuccess:()=>{f.fire({toast:!0,position:"top-end",icon:"success",title:"Subscriber dihapus",showConfirmButton:!1,timer:1500})},onError:()=>{f.fire({icon:"error",title:"Gagal",text:"Tidak bisa menghapus subscriber."})}})})};return(d,e)=>(r(),l("div",I,[x($),t("div",O,[x(D),t("main",q,[e[16]||(e[16]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"Newsletter"),t("p",{class:"text-gray-600 mt-1"},"Kelola subscriber dan kirim update terbaru.")],-1)),t("div",H,[t("div",W,[v.value?(r(),l("div",z,i(v.value),1)):g("",!0),t("div",G,[t("div",L,[e[4]||(e[4]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Cari Email",-1)),u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),onKeyup:K(p,["enter"]),type:"text",placeholder:"contoh@domain.com",class:"w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},null,544),[[b,c.value]])]),t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),u(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),onChange:p,class:"w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},e[5]||(e[5]=[t("option",{value:""},"Semua",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"inactive"},"Inactive",-1)]),544),[[N,m.value]])]),t("button",{type:"button",onClick:p,class:"px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow hover:bg-indigo-700 transition"}," Terapkan ")]),a.subscribers.data.length===0?(r(),l("div",Q," Belum ada subscriber sesuai filter. ")):(r(),l("div",R,[t("table",Y,[e[7]||(e[7]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Email"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Subscribed"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Aksi")])],-1)),t("tbody",J,[(r(!0),l(E,null,M(a.subscribers.data,s=>(r(),l("tr",{key:s.id},[t("td",P,i(s.email),1),t("td",X,[t("span",{class:A(["inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold",s.status==="active"?"bg-green-50 text-green-700":"bg-gray-100 text-gray-600"])},i(s.status),3)]),t("td",Z,i(s.subscribed_at||"-"),1),t("td",tt,[t("button",{type:"button",onClick:bt=>j(s.id),class:"text-red-600 hover:text-red-900 text-sm"}," Hapus ",8,et)])]))),128))])])])),t("div",st,[x(F,{links:a.subscribers.links},null,8,["links"])])]),t("div",ot,[t("div",it,[e[11]||(e[11]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Ringkasan",-1)),t("div",nt,[t("div",lt,[e[8]||(e[8]=t("span",null,"Total Subscriber",-1)),t("span",rt,i(a.stats.total),1)]),t("div",at,[e[9]||(e[9]=t("span",null,"Active",-1)),t("span",dt,i(a.stats.active),1)]),t("div",ut,[e[10]||(e[10]=t("span",null,"Inactive",-1)),t("span",ct,i(a.stats.inactive),1)])])]),t("div",mt,[e[14]||(e[14]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Kirim Newsletter",-1)),t("form",{onSubmit:U(C,["prevent"]),class:"space-y-4"},[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Subjek",-1)),u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>n(o).subject=s),type:"text",class:"w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Update terbaru"},null,512),[[b,n(o).subject]]),n(o).errors.subject?(r(),l("p",pt,i(n(o).errors.subject),1)):g("",!0)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Konten",-1)),u(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>n(o).content=s),rows:"6",class:"w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Tulis pesan newsletter..."},null,512),[[b,n(o).content]]),n(o).errors.content?(r(),l("p",xt,i(n(o).errors.content),1)):g("",!0)]),t("button",{type:"submit",disabled:n(o).processing,class:"w-full px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow hover:bg-indigo-700 transition disabled:opacity-50"},i(n(o).processing?"Mengirim...":"Kirim ke Subscriber Aktif"),9,gt)],32),e[15]||(e[15]=t("p",{class:"text-xs text-gray-500 mt-3"}," Newsletter akan dikirim ke semua subscriber dengan status active. ",-1))])])])])])]))}};export{kt as default};
